#!/bin/bash
set -euo pipefail
IFS=$'\n\t'

DIR=$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" &>/dev/null && pwd)

function run {
  CGO_ENABLED=0 go run ./main run --config example/Caddyfile "$@"
}

function build {
  CGO_ENABLED=0 go build -v -o caddy ./main
}

function test {
  CGO_ENABLED=0 go test . "$@"
}

function complexity {
  IGNORE="*_test.go" compl complexity "$@"
}

function graph {
  IGNORE="*_test.go" compl graph "$@"
}

function help {
  echo "$0 <task> <args>"
  echo "Tasks:"
  compgen -A function | grep -v "^_" | cat -n
}

"${@:-help}"

